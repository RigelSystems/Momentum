import{d as v,S as D,R as F,u as E,r as $,b as _,_ as b,e as w,w as s,f as l,o as p,g as r,V as I,a as S,t as y,h as N,i as g,j as A,k as C,c as h,l as T,F as k,m as V}from"./index-Qcscy6Fn.js";const B=v({name:"IconForm",props:{icon:{type:Object,required:!1,default:()=>({name:""})}},components:{RecordForm:F,SelectIcon:D},setup(o){E();const n=$([]),c=_(()=>!!o.icon.id),u=_(()=>c.value?`https://api.fordsdevelopment.co.uk/daily_discipline//icons/${o.icon.id}`:"https://api.fordsdevelopment.co.uk/daily_discipline//icons"),e=_(()=>c.value?"PUT":"POST");return{isEditMode:c,endpoint:u,method:e,handleSave:async t=>{window.location.reload()},value:n}}});function P(o,n,c,u,e,i){const t=l("n-button"),d=l("NPaint"),m=l("RecordForm");return p(),w(m,{record:o.icon,endpoint:o.endpoint,method:o.method,onSave:o.handleSave},{trigger:s(({openDialog:a})=>[N(o.$slots,"trigger",{openDialog:a},()=>[r(t,{color:"primary"},{default:s(()=>[g(y(o.isEditMode?"Edit Habit Group":"Add Habit Group"),1)]),_:1})])]),title:s(()=>[S("span",null,y(o.isEditMode?"Edit Habit Group":"Add New Habit Group"),1)]),form:s(({record:a})=>[r(I,null,{default:s(()=>[r(d,{pixelData:a.pixel_data,"onUpdate:pixelData":f=>a.pixel_data=f},null,8,["pixelData","onUpdate:pixelData"])]),_:2},1024)]),_:3},8,["record","endpoint","method","onSave"])}const U=b(B,[["render",P]]),j=v({name:"AdminView",components:{IconForm:U},setup(){console.log("AdminView setup called");const{accessToken:o}=A(),n=$([]),c=async()=>{try{const i=await fetch("https://api.fordsdevelopment.co.uk/daily_discipline//icons",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${o.value}`}});if(!i.ok)throw new Error("Failed to fetch icons");const t=await i.json();n.value=t}catch(e){console.error("Error fetching icons:",e)}};return console.log("accessToken:",o.value),C(o,e=>{e&&o.value&&(console.log("Access token changed, fetching icons..."),c())},{immediate:!0}),{accessToken:o,submitIcon:e=>{console.log("Submitting icon data:",e);try{const t=fetch("https://api.fordsdevelopment.co.uk/daily_discipline/admin/icons",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o.value}`},body:JSON.stringify(e)});if(!t.ok)throw new Error("Failed to submit icon");const d=t.json();console.log("Icon submitted successfully:",d)}catch(i){console.error("Error submitting icon:",i)}},iconData:n}}}),x={class:"standard-container p-1"},R={class:"icon-display-container"};function G(o,n,c,u,e,i){const t=l("n-button"),d=l("IconForm"),m=l("NPaintDisplay");return p(),h(k,null,[r(d,null,{trigger:s(({openDialog:a})=>[r(t,{onClick:a},{default:s(()=>n[0]||(n[0]=[g("New Icon")])),_:2},1032,["onClick"])]),_:1}),S("div",x,[o.iconData.length>0?(p(!0),h(k,{key:0},V(o.iconData,a=>(p(),h("div",R,[(p(),w(m,{key:a.id,pixelData:a.pixel_data,size:9},null,8,["pixelData"])),r(d,{icon:a},{trigger:s(({openDialog:f})=>[r(t,{onClick:f},{default:s(()=>n[1]||(n[1]=[g("Edit Icon")])),_:2},1032,["onClick"])]),_:2},1032,["icon"])]))),256)):T("",!0)])],64)}const O=b(j,[["render",G]]);export{O as default};
