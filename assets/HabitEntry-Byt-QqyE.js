import{q as ke,d as M,_ as z,c as I,a as $,g as t,i as X,w as p,f as T,t as S,o as u,x as fe,j as pe,r as E,b as B,k as Y,e as P,l as V,F as H,m as x,y as ee,z as R,h as W,A as N,B as U,C as be,D as w,E as L,G,H as oe,I as te,n as ae,J as _,K as re,L as j,M as ge,N as Ce,O as Ie,Q as Se,S as Ve,T as $e,U as Ae,W as Te,X as Ee,Y as Pe,Z as Be,$ as Ne,a0 as we,a1 as De,a2 as D,a3 as He,a4 as Ue,a5 as Le,a6 as Fe,a7 as qe,a8 as Oe,a9 as Re,aa as _e,ab as je,ac as Me,ad as ze,ae as We,af as Ye,ag as Je,ah as Ke,ai as Xe,aj as Ge,ak as Qe,al as Ze,am as xe,an as et,ao as ne,ap as tt,aq as at,ar as O}from"./index-BGU5o5H4.js";import{S as nt}from"./SelectIcon-BHRwP6xQ.js";import{C as ce}from"./ChecklistItemForm-BacoGyN-.js";function _t(e=1,n="YYYY-MM-DD"){return Array.from({length:e},(l,a)=>ke().subtract(a,"day").format(n))}const lt=M({name:"ChecklistItemWeightedExercise",components:{ChecklistItemForm:ce},props:{checklistItem:{type:Object,required:!0}}}),st={class:"n-container-style"},it={class:"mdi mdi-weight"},ot={class:"mdi mdi-repeat"},rt={class:"mdi mdi-sleep"};function ct(e,n,l,a,h,g){const i=T("NButton"),m=T("ChecklistItemForm");return u(),I("div",st,[$("h3",null,[t(m,{checklistItem:e.checklistItem},{trigger:p(({openDialog:o})=>[t(i,{icon:"mdi-pencil-box-outline",onClick:o,size:"medium"},null,8,["onClick"])]),_:1},8,["checklistItem"]),X(" "+S(e.checklistItem.name),1)]),$("p",null,[$("span",it,S(e.checklistItem.weight)+S(e.checklistItem.unit),1),$("span",ot,S(e.checklistItem.sets)+" × "+S(e.checklistItem.reps),1),$("span",rt,S(e.checklistItem.rest)+" secs",1)])])}const dt=z(lt,[["render",ct],["__scopeId","data-v-de8d419b"]]),ut=M({name:"ChecklistItemTask",components:{ChecklistItemForm:ce},props:{checklistItem:{type:Object,required:!0}},setup(e,{emit:n}){return{handleSave:()=>{n("save")}}}}),mt={class:"n-container-style"},vt={class:"checklist-item-name"},ht={class:"checklist-item-status"};function yt(e,n,l,a,h,g){const i=T("n-button"),m=T("ChecklistItemForm");return u(),I("div",mt,[$("h3",vt,S(e.checklistItem.name),1),$("div",ht,S(e.checklistItem.status),1),t(m,{onSave:e.handleSave,checklistItem:e.checklistItem},{trigger:p(({openDialog:o})=>[t(i,{onClick:o},{default:p(()=>n[0]||(n[0]=[X("Edit item")])),_:2},1032,["onClick"])]),_:1},8,["onSave","checklistItem"])])}const kt=z(ut,[["render",yt]]),ft=M({name:"HabitEntryChecklist",components:{ChecklistItemWeightedExercise:dt,ChecklistItemTask:kt},props:{colour:{type:String,required:!0},date:{type:String,required:!0},value:{type:Number,required:!1}},setup(e){const{colour:n,value:l}=fe(e),{accessToken:a}=pe(),h=E(!1),g=E(null),i=E(null),m=E(!1),o=E(0),d=E(1),s=B(()=>({backgroundColor:l.value?n.value:"#f0f0f0"})),y=B(()=>{var c;return((c=i.value)==null?void 0:c.checklist_items[o.value])??null}),C="https://api.rigelsystems.co.uk/daily_discipline//checklists",b=async c=>{try{const A=await fetch(`${C}/${c}`,{headers:{Authorization:`Bearer ${a.value}`}});if(!A.ok)throw new Error(`Checklist fetch failed: ${A.status}`);i.value=await A.json()}catch(A){console.error(A)}};return Y(g,c=>c&&b(c)),{show:h,checklistId:g,checklist:i,checklistStarted:m,currentItemIdx:o,currentSetIdx:d,styles:s,currentItem:y,checklistUrl:C,openDialog:()=>h.value=!0,closeDialog:()=>h.value=!1,startChecklist:()=>m.value=!0,nextAction:()=>{const c=y.value;c&&(c.sets&&d.value<c.sets?d.value++:(o.value++,d.value=1))},accessToken:a}}}),pt={class:"n-modal__title"},bt={key:1,class:"standard-container-1"},gt={key:2};function Ct(e,n,l,a,h,g){const i=T("NButton"),m=T("NSelectInputFromRequest"),o=T("NCircleProgress"),d=T("NModal");return u(),P(d,{show:e.show,"onUpdate:show":n[2]||(n[2]=s=>e.show=s)},{trigger:p(({openModal:s})=>[W(e.$slots,"trigger",{openDialog:s},()=>[t(i,{class:"habit-entry",style:R(e.styles),onClick:s},null,8,["style","onClick"])])]),header:p(()=>[W(e.$slots,"title",{},()=>[$("h2",pt,"Checklist - "+S(e.date),1)])]),footer:p(()=>[W(e.$slots,"actions",{},()=>{var s;return[e.checklistStarted?(u(),P(i,{key:0,label:"Back",onClick:n[1]||(n[1]=y=>e.currentItemIdx--)})):V("",!0),t(i,{class:"mx-2",colour:"secondary",label:"Cancel",onClick:e.closeDialog},null,8,["onClick"]),e.checklistId&&((s=e.checklist)!=null&&s.checklist_items)&&!e.checklistStarted?(u(),P(i,{key:1,label:"Start",onClick:e.startChecklist},null,8,["onClick"])):V("",!0),e.checklistStarted?(u(),P(i,{key:2,label:"Next",onClick:e.nextAction},null,8,["onClick"])):V("",!0)]})]),default:p(()=>{var s,y,C,b;return[e.checklistStarted?V("",!0):(u(),P(m,{key:0,url:e.checklistUrl,valueKey:"id",name:"role",label:"Select Checklist",modelValue:e.checklistId,"onUpdate:modelValue":n[0]||(n[0]=v=>e.checklistId=v),accessToken:e.accessToken},null,8,["url","modelValue","accessToken"])),e.checklistStarted?V("",!0):(u(),I("div",bt,[(u(!0),I(H,null,x((s=e.checklist)==null?void 0:s.checklist_items,v=>(u(),P(ee(`ChecklistItem${v.checklist_item_type_classify}`),{key:v.id,checklistItem:v},null,8,["checklistItem"]))),128))])),e.checklistStarted?(u(),I("div",gt,[n[3]||(n[3]=$("p",{class:"text-center"}," You have started the checklist. Please complete the items in your checklist. ",-1)),t(o,{current:e.currentItemIdx+1,total:(y=e.checklist)==null?void 0:y.checklist_items.length,fontSize:35,size:40,strokeWidth:11,progressColor:"#88bdb9"},null,8,["current","total"]),(u(),P(ee(`ChecklistItem${(C=e.currentItem)==null?void 0:C.checklist_item_type_classify}`),{checklistItem:e.currentItem},null,8,["checklistItem"])),(u(!0),I(H,null,x((b=e.currentItem)==null?void 0:b.sets,v=>{var k,r;return u(),I("div",{key:v},[$("p",{style:R({border:v===e.currentSetIdx?"1px solid grey":""})},[$("strong",null,"Set "+S(v)+":",1),X(" "+S((k=e.currentItem)==null?void 0:k.reps)+" reps at "+S((r=e.currentItem)==null?void 0:r.weight)+" kg ",1)],4)])}),128))])):V("",!0)]}),_:3},8,["show"])}const It=z(ft,[["render",Ct]]),St=M({name:"HabitEntry",props:{accessToken:{type:String,required:!1},entry:{type:Object,required:!1},habit:{type:Object,required:!0},date:{type:String,required:!0},colour:{type:String,required:!0},loading:{type:Boolean,required:!1}},components:{SelectIcon:nt,HabitEntryChecklist:It},setup(e,{emit:n}){var k;let l=!1,a=E(((k=e.entry)==null?void 0:k.value)||0);const h=B(()=>{if(e.habit.habit_type==="Numerical")return a.value||"-";if(e.habit.habit_type==="Currency")return`£${a.value||"-"}`}),g=B(()=>{var A,F,q;let r=null,f=((q=(F=(A=e.entry)==null?void 0:A.value)==null?void 0:F.toString())==null?void 0:q.length)||0;e.habit.habit_type==="Currency"&&(f+=1);const c=a.value?`${e.colour} !important`:null;return f===1?r="18px":f===2?r="16px":f===3?r="10px":f===4?r="8px":f>=5&&(r="5px"),{fontSize:r,backgroundColor:c}}),i=async r=>{l=!0;const f=`https://api.rigelsystems.co.uk/daily_discipline/habit_entries/${e.entry.id}`;return await fetch(f,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.accessToken}`},body:JSON.stringify({value:r})})},m=async r=>(l=!0,await fetch("https://api.rigelsystems.co.uk/daily_discipline/habit_entries",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.accessToken}`},body:JSON.stringify({habit_id:e.habit.id,date:e.date,value:r})})),o=async r=>{l=!0;const f=e.entry?await i(r):await m(r);if(f.ok){l=!1;const c=await f.json();a.value=c.value,console.log("updated entry",c),n("updated")}else{l=!1;const c=await f.json();console.error(c)}};let d;const s=E(!1),y=()=>{d=setTimeout(()=>{s.value=!0},500)},C=()=>{clearTimeout(d)},b=r=>{r&&o(r)};return{entry:e.entry,updateEntry:o,loading:l,value:a,startHold:y,endHold:C,modalIsActive:s,updateRecordIcon:b,checklistUrl:"https://api.rigelsystems.co.uk/daily_discipline/checklists",habitEntryStyle:g,habitValueForNumericalOrCurrency:h}}}),J=N()({name:"VCardActions",props:U(),setup(e,n){let{slots:l}=n;return be({VBtn:{slim:!0,variant:"text"}}),w(()=>{var a;return t("div",{class:["v-card-actions",e.class],style:e.style},[(a=l.default)==null?void 0:a.call(l)])}),{}}}),Vt=L({opacity:[Number,String],...U(),...G()},"VCardSubtitle"),$t=N()({name:"VCardSubtitle",props:Vt(),setup(e,n){let{slots:l}=n;return w(()=>t(e.tag,{class:["v-card-subtitle",e.class],style:[{"--v-card-subtitle-opacity":e.opacity},e.style]},l)),{}}}),At=oe("v-card-title"),Tt=L({appendAvatar:String,appendIcon:j,prependAvatar:String,prependIcon:j,subtitle:{type:[String,Number,Boolean],default:void 0},title:{type:[String,Number,Boolean],default:void 0},...U(),...re()},"VCardItem"),Et=N()({name:"VCardItem",props:Tt(),setup(e,n){let{slots:l}=n;return w(()=>{var d;const a=!!(e.prependAvatar||e.prependIcon),h=!!(a||l.prepend),g=!!(e.appendAvatar||e.appendIcon),i=!!(g||l.append),m=!!(e.title!=null||l.title),o=!!(e.subtitle!=null||l.subtitle);return t("div",{class:["v-card-item",e.class],style:e.style},[h&&t("div",{key:"prepend",class:"v-card-item__prepend"},[l.prepend?t(_,{key:"prepend-defaults",disabled:!a,defaults:{VAvatar:{density:e.density,image:e.prependAvatar},VIcon:{density:e.density,icon:e.prependIcon}}},l.prepend):t(H,null,[e.prependAvatar&&t(te,{key:"prepend-avatar",density:e.density,image:e.prependAvatar},null),e.prependIcon&&t(ae,{key:"prepend-icon",density:e.density,icon:e.prependIcon},null)])]),t("div",{class:"v-card-item__content"},[m&&t(At,{key:"title"},{default:()=>{var s;return[((s=l.title)==null?void 0:s.call(l))??S(e.title)]}}),o&&t($t,{key:"subtitle"},{default:()=>{var s;return[((s=l.subtitle)==null?void 0:s.call(l))??S(e.subtitle)]}}),(d=l.default)==null?void 0:d.call(l)]),i&&t("div",{key:"append",class:"v-card-item__append"},[l.append?t(_,{key:"append-defaults",disabled:!g,defaults:{VAvatar:{density:e.density,image:e.appendAvatar},VIcon:{density:e.density,icon:e.appendIcon}}},l.append):t(H,null,[e.appendIcon&&t(ae,{key:"append-icon",density:e.density,icon:e.appendIcon},null),e.appendAvatar&&t(te,{key:"append-avatar",density:e.density,image:e.appendAvatar},null)])])])}),{}}}),Pt=L({opacity:[Number,String],...U(),...G()},"VCardText"),K=N()({name:"VCardText",props:Pt(),setup(e,n){let{slots:l}=n;return w(()=>t(e.tag,{class:["v-card-text",e.class],style:[{"--v-card-text-opacity":e.opacity},e.style]},l)),{}}}),Bt=L({appendAvatar:String,appendIcon:j,disabled:Boolean,flat:Boolean,hover:Boolean,image:String,link:{type:Boolean,default:void 0},prependAvatar:String,prependIcon:j,ripple:{type:[Boolean,Object],default:!0},subtitle:{type:[String,Number,Boolean],default:void 0},text:{type:[String,Number,Boolean],default:void 0},title:{type:[String,Number,Boolean],default:void 0},...Me(),...U(),...re(),...je(),..._e(),...Re(),...Oe(),...qe(),...Fe(),...Le(),...G(),...Ue(),...He({variant:"elevated"})},"VCard"),le=N()({name:"VCard",directives:{Ripple:ge},props:Bt(),setup(e,n){let{attrs:l,slots:a}=n;const{themeClasses:h}=Ce(e),{borderClasses:g}=Ie(e),{colorClasses:i,colorStyles:m,variantClasses:o}=Se(e),{densityClasses:d}=Ve(e),{dimensionStyles:s}=$e(e),{elevationClasses:y}=Ae(e),{loaderClasses:C}=Te(e),{locationStyles:b}=Ee(e),{positionClasses:v}=Pe(e),{roundedClasses:k}=Be(e),r=Ne(e,l),f=B(()=>e.link!==!1&&r.isLink.value),c=B(()=>!e.disabled&&e.link!==!1&&(e.link||r.isClickable.value));return w(()=>{const A=f.value?"a":e.tag,F=!!(a.title||e.title!=null),q=!!(a.subtitle||e.subtitle!=null),de=F||q,ue=!!(a.append||e.appendAvatar||e.appendIcon),me=!!(a.prepend||e.prependAvatar||e.prependIcon),ve=!!(a.image||e.image),he=de||me||ue,ye=!!(a.text||e.text!=null);return we(t(A,D({class:["v-card",{"v-card--disabled":e.disabled,"v-card--flat":e.flat,"v-card--hover":e.hover&&!(e.disabled||e.flat),"v-card--link":c.value},h.value,g.value,i.value,d.value,y.value,C.value,v.value,k.value,o.value,e.class],style:[m.value,s.value,b.value,e.style],onClick:c.value&&r.navigate,tabindex:e.disabled?-1:void 0},r.linkProps),{default:()=>{var Q;return[ve&&t("div",{key:"image",class:"v-card__image"},[a.image?t(_,{key:"image-defaults",disabled:!e.image,defaults:{VImg:{cover:!0,src:e.image}}},a.image):t(We,{key:"image-img",cover:!0,src:e.image},null)]),t(Ye,{name:"v-card",active:!!e.loading,color:typeof e.loading=="boolean"?void 0:e.loading},{default:a.loader}),he&&t(Et,{key:"item",prependAvatar:e.prependAvatar,prependIcon:e.prependIcon,title:e.title,subtitle:e.subtitle,appendAvatar:e.appendAvatar,appendIcon:e.appendIcon},{default:a.item,prepend:a.prepend,title:a.title,subtitle:a.subtitle,append:a.append}),ye&&t(K,{key:"text"},{default:()=>{var Z;return[((Z=a.text)==null?void 0:Z.call(a))??e.text]}}),(Q=a.default)==null?void 0:Q.call(a),a.actions&&t(J,null,{default:a.actions}),ze(c.value,"v-card")]}}),[[De("ripple"),c.value&&e.ripple]])}),{}}}),Nt=L({fullscreen:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,...Ze({origin:"center center",scrollStrategy:"block",transition:{component:xe},zIndex:2400})},"VDialog"),se=N()({name:"VDialog",props:Nt(),emits:{"update:modelValue":e=>!0,afterEnter:()=>!0,afterLeave:()=>!0},setup(e,n){let{emit:l,slots:a}=n;const h=Je(e,"modelValue"),{scopeId:g}=Ke(),i=E();function m(s){var b,v;const y=s.relatedTarget,C=s.target;if(y!==C&&((b=i.value)!=null&&b.contentEl)&&((v=i.value)!=null&&v.globalTop)&&![document,i.value.contentEl].includes(C)&&!i.value.contentEl.contains(C)){const k=et(i.value.contentEl);if(!k.length)return;const r=k[0],f=k[k.length-1];y===r?f.focus():r.focus()}}Xe(()=>{document.removeEventListener("focusin",m)}),Ge&&Y(()=>h.value&&e.retainFocus,s=>{s?document.addEventListener("focusin",m):document.removeEventListener("focusin",m)},{immediate:!0});function o(){var s;l("afterEnter"),(s=i.value)!=null&&s.contentEl&&!i.value.contentEl.contains(document.activeElement)&&i.value.contentEl.focus({preventScroll:!0})}function d(){l("afterLeave")}return Y(h,async s=>{var y;s||(await tt(),(y=i.value.activatorEl)==null||y.focus({preventScroll:!0}))}),w(()=>{const s=ne.filterProps(e),y=D({"aria-haspopup":"dialog"},e.activatorProps),C=D({tabindex:-1},e.contentProps);return t(ne,D({ref:i,class:["v-dialog",{"v-dialog--fullscreen":e.fullscreen,"v-dialog--scrollable":e.scrollable},e.class],style:e.style},s,{modelValue:h.value,"onUpdate:modelValue":b=>h.value=b,"aria-modal":"true",activatorProps:y,contentProps:C,height:e.fullscreen?void 0:e.height,width:e.fullscreen?void 0:e.width,maxHeight:e.fullscreen?void 0:e.maxHeight,maxWidth:e.fullscreen?void 0:e.maxWidth,role:"dialog",onAfterEnter:o,onAfterLeave:d},g),{activator:a.activator,default:function(){for(var b=arguments.length,v=new Array(b),k=0;k<b;k++)v[k]=arguments[k];return t(_,{root:"VDialog"},{default:()=>{var r;return[(r=a.default)==null?void 0:r.call(a,...v)]}})}})}),Qe({},i)}}),ie=oe("v-spacer","div","VSpacer"),wt={key:0},Dt={key:1},Ht={key:2},Ut={key:3},Lt={key:4};function Ft(e,n,l,a,h,g){const i=T("SelectIcon"),m=T("HabitEntryChecklist");return u(),I(H,null,[e.loading?(u(),I("div",wt,"Loading...")):V("",!0),e.habit.habit_type==="Yes or No"?(u(),I("div",Dt,[e.value==="1"?(u(),I("button",{key:0,onClick:n[0]||(n[0]=o=>e.updateEntry("0")),class:"habit-entry habit-entry--check",style:R({backgroundColor:e.colour})},null,4)):(u(),I("button",{key:1,onClick:n[1]||(n[1]=o=>e.updateEntry("1")),class:"habit-entry habit-entry--close"}))])):V("",!0),e.habit.habit_type==="Numerical"||e.habit.habit_type==="Currency"?(u(),I("div",Ht,[t(se,{"max-width":"500",modelValue:e.modalIsActive,"onUpdate:modelValue":n[4]||(n[4]=o=>e.modalIsActive=o),persistent:""},{activator:p(({props:o})=>[t(O,{onClick:n[2]||(n[2]=d=>e.updateEntry((parseInt(e.value)+1).toString())),onMousedown:e.startHold,onMouseup:e.endHold,onTouchstart:e.startHold,onTouchend:e.endHold,color:"surface-variant",text:e.habitValueForNumericalOrCurrency,variant:"flat",class:"habit-entry habit-entry--number",style:R(e.habitEntryStyle)},null,8,["onMousedown","onMouseup","onTouchstart","onTouchend","text","style"])]),default:p(({isActive:o})=>[t(le,{title:`${e.habit.name}: ${e.date}`},{default:p(()=>[t(K,null,{default:p(()=>[t(at,{modelValue:e.value,"onUpdate:modelValue":n[3]||(n[3]=d=>e.value=d),label:"Value",type:"number"},null,8,["modelValue"])]),_:1}),t(J,null,{default:p(()=>[t(ie),t(O,{text:"Update Entry",onClick:d=>{o.value=!1,e.updateEntry(e.value)}},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["title"])]),_:1},8,["modelValue"])])):V("",!0),e.habit.habit_type==="Icon"?(u(),I("div",Ut,[t(se,{"max-width":"500",modelValue:e.modalIsActive,"onUpdate:modelValue":n[6]||(n[6]=o=>e.modalIsActive=o),persistent:""},{activator:p(({props:o})=>[t(O,D(o,{onTouchstart:e.startHold,onTouchend:e.endHold,color:"surface-variant",variant:"flat",class:`habit-entry habit-entry--number mdi mdi-${e.value}`,style:e.value=="0"||e.value===null?null:{backgroundColor:`${e.colour} !important`}}),null,16,["onTouchstart","onTouchend","class","style"])]),default:p(({isActive:o})=>[t(le,{title:`${e.habit.name}: ${e.date}`},{default:p(()=>[t(K,null,{default:p(()=>[t(i,{modelValue:e.value.value,"onUpdate:modelValue":n[5]||(n[5]=d=>e.value.value=d),onUpdate:e.updateRecordIcon},null,8,["modelValue","onUpdate"])]),_:1}),t(J,null,{default:p(()=>[t(ie),t(O,{text:"Update Entry",onClick:d=>o.value=!1},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["title"])]),_:1},8,["modelValue"])])):V("",!0),e.habit.habit_type==="Checklist"?(u(),I("div",Lt,[t(m,{colour:e.colour,date:e.date,value:e.value},null,8,["colour","date","value"])])):V("",!0)],64)}const jt=z(St,[["render",Ft]]);export{jt as H,_t as g};
