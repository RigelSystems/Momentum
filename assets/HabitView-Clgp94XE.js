import{d as w,P as E,m as $,r as n,v as F,x as V,p as g,_ as M,c as r,a as t,g as b,f,w as B,y as N,F as H,s as _,o,l as S,e as C,q as L}from"./index-C6fo9xuz.js";import{a as P}from"./Habit-CNkkkUe4.js";import{H as Y,g as k}from"./dateUtils-iiByr1nf.js";import{r as A}from"./requestApi-BANzWHP8.js";const q=w({name:"HabitView",components:{PageHeader:E,HabitEntry:Y,Habit:P},setup(){const e=k(30,"YYYY-MM-DD"),c=k(30,"ddd<br>D"),{getAccessTokenSilently:y,user:D}=$(),u=n(null),v=n(null),h=n(!0),l=n([{title:"Habits",disabled:!1,href:"/#/habits"}]),d=n({}),a=F(),m=n(a.params.id);V(()=>a.params.id,i=>{m.value=i}),g(async()=>{const i=`https://api.fordsdevelopment.co.uk/daily_discipline/habits/${m.value}`,p=A(i,"GET");try{const s=await p();console.log("Habit data:",s),d.value=s,l.value.push({title:s.name,disabled:!0,href:`/habits/${m}`})}catch{v.value="Failed to fetch records"}h.value=!1});const T=async()=>{u.value=await y()};return g(async()=>{await T()}),{habit:d,breadcrumbs:l,lastSevenDays:e,lastSevenDaysNice:c,getHabitEntiryForDate:(i,p)=>i.habit_entries.find(s=>s.date===p),accessToken:u}}}),I={class:"page-header"},R={class:"page-wrapper"},z={class:"completion-percentages-container"},G=["innerHTML"],U={class:"habit-entires__container"},X={class:"table-habit-name"};function j(e,c,y,D,u,v){const h=f("PageHeader"),l=f("Habit"),d=f("HabitEntry");return o(),r(H,null,[t("div",I,[b(h,{title:e.habit.name},null,8,["title"]),b(N,{items:e.breadcrumbs},{prepend:B(()=>[b(S,{icon:"$vuetify",size:"small"})]),_:1},8,["items"])]),t("div",R,[t("div",z,[c[0]||(c[0]=t("div",{class:"table-habit-name"},null,-1)),(o(!0),r(H,null,_(e.lastSevenDaysNice,a=>(o(),r("small",{class:"table-cell",key:a},[t("span",{class:"table-date",innerHTML:a},null,8,G)]))),128))]),t("div",U,[t("div",X,[b(l,{habit:e.habit,fetchHabits:e.fetchHabits},null,8,["habit","fetchHabits"])]),(o(!0),r(H,null,_(e.lastSevenDays,a=>(o(),r("div",{class:"table-cell",key:a},[e.accessToken?(o(),C(d,{key:0,entry:e.getHabitEntiryForDate(e.habit,a),habit:e.habit,date:a,colour:e.habit.colour,fetchHabits:e.fetchHabits,accessToken:e.accessToken},null,8,["entry","habit","date","colour","fetchHabits","accessToken"])):L("",!0)]))),128))])])],64)}const Z=M(q,[["render",j]]);export{Z as default};
