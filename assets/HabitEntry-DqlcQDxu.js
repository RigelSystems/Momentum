import{q as ye,d as O,_,c as I,a as $,g as t,i as J,w as f,f as A,t as C,o as u,x as fe,j as pe,r as T,b as D,k as z,e as P,l as V,F as H,m as Q,y as Z,z as q,h as M,A as B,B as U,C as ge,D as w,E as L,G as K,H as se,I as x,n as ee,J as R,K as oe,L as j,M as be,N as Ie,O as Ce,Q as Se,S as Ve,T as $e,U as Ae,W as Te,X as Ee,Y as Pe,Z as Be,$ as we,a0 as Ne,a1 as De,a2 as N,a3 as He,a4 as Ue,a5 as Le,a6 as Fe,a7 as qe,a8 as Re,a9 as je,aa as Oe,ab as _e,ac as Me,ad as ze,ae as We,af as Ye,ag as Je,ah as Ke,ai as Xe,aj as Ge,ak as Qe,al as Ze,am as xe,an as et,ao as te,ap as tt,aq as at,ar as F}from"./index-DSd1PwLk.js";import{S as nt}from"./SelectIcon-CMcsiTzv.js";import{C as ie}from"./ChecklistItemForm-C0NaTpaZ.js";function Ot(e=1,a="YYYY-MM-DD"){return Array.from({length:e},(l,n)=>ye().subtract(n,"day").format(a))}const lt=O({name:"ChecklistItemWeightedExercise",components:{ChecklistItemForm:ie},props:{checklistItem:{type:Object,required:!0}}}),st={class:"n-container-style"},ot={class:"mdi mdi-weight"},it={class:"mdi mdi-repeat"},rt={class:"mdi mdi-sleep"};function ct(e,a,l,n,k,p){const o=A("NButton"),m=A("ChecklistItemForm");return u(),I("div",st,[$("h3",null,[t(m,{checklistItem:e.checklistItem},{trigger:f(({openDialog:r})=>[t(o,{icon:"mdi-pencil-box-outline",onClick:r,size:"medium"},null,8,["onClick"])]),_:1},8,["checklistItem"]),J(" "+C(e.checklistItem.name),1)]),$("p",null,[$("span",ot,C(e.checklistItem.weight)+C(e.checklistItem.unit),1),$("span",it,C(e.checklistItem.sets)+" Ã— "+C(e.checklistItem.reps),1),$("span",rt,C(e.checklistItem.rest)+" secs",1)])])}const dt=_(lt,[["render",ct],["__scopeId","data-v-de8d419b"]]),ut=O({name:"ChecklistItemTask",components:{ChecklistItemForm:ie},props:{checklistItem:{type:Object,required:!0}},setup(e,{emit:a}){return{handleSave:()=>{a("save")}}}}),mt={class:"n-container-style"},vt={class:"checklist-item-name"},ht={class:"checklist-item-status"};function kt(e,a,l,n,k,p){const o=A("n-button"),m=A("ChecklistItemForm");return u(),I("div",mt,[$("h3",vt,C(e.checklistItem.name),1),$("div",ht,C(e.checklistItem.status),1),t(m,{onSave:e.handleSave,checklistItem:e.checklistItem},{trigger:f(({openDialog:r})=>[t(o,{onClick:r},{default:f(()=>a[0]||(a[0]=[J("Edit item")])),_:2},1032,["onClick"])]),_:1},8,["onSave","checklistItem"])])}const yt=_(ut,[["render",kt]]),ft=O({name:"HabitEntryChecklist",components:{ChecklistItemWeightedExercise:dt,ChecklistItemTask:yt},props:{colour:{type:String,required:!0},date:{type:String,required:!0},value:{type:Number,required:!1}},setup(e){const{colour:a,value:l}=fe(e),{accessToken:n}=pe(),k=T(!1),p=T(null),o=T(null),m=T(!1),r=T(0),d=T(1),s=D(()=>({backgroundColor:l.value?a.value:"#f0f0f0"})),y=D(()=>{var h;return((h=o.value)==null?void 0:h.checklist_items[r.value])??null}),g="https://api.fordsdevelopment.co.uk/daily_discipline//checklists",b=async h=>{try{const E=await fetch(`${g}/${h}`,{headers:{Authorization:`Bearer ${n.value}`}});if(!E.ok)throw new Error(`Checklist fetch failed: ${E.status}`);o.value=await E.json()}catch(E){console.error(E)}};return z(p,h=>h&&b(h)),{show:k,checklistId:p,checklist:o,checklistStarted:m,currentItemIdx:r,currentSetIdx:d,styles:s,currentItem:y,checklistUrl:g,openDialog:()=>k.value=!0,closeDialog:()=>k.value=!1,startChecklist:()=>m.value=!0,nextAction:()=>{const h=y.value;h&&(h.sets&&d.value<h.sets?d.value++:(r.value++,d.value=1))},accessToken:n}}}),pt={class:"n-modal__title"},gt={key:1,class:"standard-container-1"},bt={key:2};function It(e,a,l,n,k,p){const o=A("NButton"),m=A("NSelectInputFromRequest"),r=A("NCircleProgress"),d=A("NModal");return u(),P(d,{show:e.show,"onUpdate:show":a[2]||(a[2]=s=>e.show=s)},{trigger:f(({openModal:s})=>[M(e.$slots,"trigger",{openDialog:s},()=>[t(o,{class:"habit-entry",style:q(e.styles),onClick:s},null,8,["style","onClick"])])]),header:f(()=>[M(e.$slots,"title",{},()=>[$("h2",pt,"Checklist - "+C(e.date),1)])]),footer:f(()=>[M(e.$slots,"actions",{},()=>{var s;return[e.checklistStarted?(u(),P(o,{key:0,label:"Back",onClick:a[1]||(a[1]=y=>e.currentItemIdx--)})):V("",!0),t(o,{class:"mx-2",colour:"secondary",label:"Cancel",onClick:e.closeDialog},null,8,["onClick"]),e.checklistId&&((s=e.checklist)!=null&&s.checklist_items)&&!e.checklistStarted?(u(),P(o,{key:1,label:"Start",onClick:e.startChecklist},null,8,["onClick"])):V("",!0),e.checklistStarted?(u(),P(o,{key:2,label:"Next",onClick:e.nextAction},null,8,["onClick"])):V("",!0)]})]),default:f(()=>{var s,y,g,b;return[e.checklistStarted?V("",!0):(u(),P(m,{key:0,url:e.checklistUrl,valueKey:"id",name:"role",label:"Select Checklist",modelValue:e.checklistId,"onUpdate:modelValue":a[0]||(a[0]=v=>e.checklistId=v),accessToken:e.accessToken},null,8,["url","modelValue","accessToken"])),e.checklistStarted?V("",!0):(u(),I("div",gt,[(u(!0),I(H,null,Q((s=e.checklist)==null?void 0:s.checklist_items,v=>(u(),P(Z(`ChecklistItem${v.checklist_item_type_classify}`),{key:v.id,checklistItem:v},null,8,["checklistItem"]))),128))])),e.checklistStarted?(u(),I("div",bt,[a[3]||(a[3]=$("p",{class:"text-center"}," You have started the checklist. Please complete the items in your checklist. ",-1)),t(r,{current:e.currentItemIdx+1,total:(y=e.checklist)==null?void 0:y.checklist_items.length,fontSize:35,size:40,strokeWidth:11,progressColor:"#88bdb9"},null,8,["current","total"]),(u(),P(Z(`ChecklistItem${(g=e.currentItem)==null?void 0:g.checklist_item_type_classify}`),{checklistItem:e.currentItem},null,8,["checklistItem"])),(u(!0),I(H,null,Q((b=e.currentItem)==null?void 0:b.sets,v=>{var i,c;return u(),I("div",{key:v},[$("p",{style:q({border:v===e.currentSetIdx?"1px solid grey":""})},[$("strong",null,"Set "+C(v)+":",1),J(" "+C((i=e.currentItem)==null?void 0:i.reps)+" reps at "+C((c=e.currentItem)==null?void 0:c.weight)+" kg ",1)],4)])}),128))])):V("",!0)]}),_:3},8,["show"])}const Ct=_(ft,[["render",It]]),St=O({name:"HabitEntry",props:{accessToken:{type:String,required:!1},entry:{type:Object,required:!1},habit:{type:Object,required:!0},date:{type:String,required:!0},colour:{type:String,required:!0},loading:{type:Boolean,required:!1}},components:{SelectIcon:nt,HabitEntryChecklist:Ct},setup(e,{emit:a}){var v;let l=!1,n=T(((v=e.entry)==null?void 0:v.value)||0);const k=D(()=>{var h;let i=null;const c=(h=e.entry)==null?void 0:h.value.toString().length,S=n.value?`${e.colour} !important`:null;return c===1?i="18px":c===2?i="16px":c===3?i="10px":c===4?i="8px":c>=5&&(i="6px"),{fontSize:i,backgroundColor:S}}),p=async i=>{l=!0;const c=`https://api.fordsdevelopment.co.uk/daily_discipline/habit_entries/${e.entry.id}`;return await fetch(c,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.accessToken}`},body:JSON.stringify({value:i})})},o=async i=>(l=!0,await fetch("https://api.fordsdevelopment.co.uk/daily_discipline/habit_entries",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.accessToken}`},body:JSON.stringify({habit_id:e.habit.id,date:e.date,value:i})})),m=async i=>{l=!0;const c=e.entry?await p(i):await o(i);if(c.ok){l=!1;const S=await c.json();n.value=S.value,console.log("updated entry",S),a("updated")}else{l=!1;const S=await c.json();console.error(S)}};let r;const d=T(!1),s=()=>{r=setTimeout(()=>{d.value=!0},500)},y=()=>{clearTimeout(r)},g=i=>{i&&m(i)};return{entry:e.entry,updateEntry:m,loading:l,value:n,startHold:s,endHold:y,modalIsActive:d,updateRecordIcon:g,checklistUrl:"https://api.fordsdevelopment.co.uk/daily_discipline/checklists",habitEntryStyle:k}}}),W=B()({name:"VCardActions",props:U(),setup(e,a){let{slots:l}=a;return ge({VBtn:{slim:!0,variant:"text"}}),w(()=>{var n;return t("div",{class:["v-card-actions",e.class],style:e.style},[(n=l.default)==null?void 0:n.call(l)])}),{}}}),Vt=L({opacity:[Number,String],...U(),...K()},"VCardSubtitle"),$t=B()({name:"VCardSubtitle",props:Vt(),setup(e,a){let{slots:l}=a;return w(()=>t(e.tag,{class:["v-card-subtitle",e.class],style:[{"--v-card-subtitle-opacity":e.opacity},e.style]},l)),{}}}),At=se("v-card-title"),Tt=L({appendAvatar:String,appendIcon:j,prependAvatar:String,prependIcon:j,subtitle:{type:[String,Number,Boolean],default:void 0},title:{type:[String,Number,Boolean],default:void 0},...U(),...oe()},"VCardItem"),Et=B()({name:"VCardItem",props:Tt(),setup(e,a){let{slots:l}=a;return w(()=>{var d;const n=!!(e.prependAvatar||e.prependIcon),k=!!(n||l.prepend),p=!!(e.appendAvatar||e.appendIcon),o=!!(p||l.append),m=!!(e.title!=null||l.title),r=!!(e.subtitle!=null||l.subtitle);return t("div",{class:["v-card-item",e.class],style:e.style},[k&&t("div",{key:"prepend",class:"v-card-item__prepend"},[l.prepend?t(R,{key:"prepend-defaults",disabled:!n,defaults:{VAvatar:{density:e.density,image:e.prependAvatar},VIcon:{density:e.density,icon:e.prependIcon}}},l.prepend):t(H,null,[e.prependAvatar&&t(x,{key:"prepend-avatar",density:e.density,image:e.prependAvatar},null),e.prependIcon&&t(ee,{key:"prepend-icon",density:e.density,icon:e.prependIcon},null)])]),t("div",{class:"v-card-item__content"},[m&&t(At,{key:"title"},{default:()=>{var s;return[((s=l.title)==null?void 0:s.call(l))??C(e.title)]}}),r&&t($t,{key:"subtitle"},{default:()=>{var s;return[((s=l.subtitle)==null?void 0:s.call(l))??C(e.subtitle)]}}),(d=l.default)==null?void 0:d.call(l)]),o&&t("div",{key:"append",class:"v-card-item__append"},[l.append?t(R,{key:"append-defaults",disabled:!p,defaults:{VAvatar:{density:e.density,image:e.appendAvatar},VIcon:{density:e.density,icon:e.appendIcon}}},l.append):t(H,null,[e.appendIcon&&t(ee,{key:"append-icon",density:e.density,icon:e.appendIcon},null),e.appendAvatar&&t(x,{key:"append-avatar",density:e.density,image:e.appendAvatar},null)])])])}),{}}}),Pt=L({opacity:[Number,String],...U(),...K()},"VCardText"),Y=B()({name:"VCardText",props:Pt(),setup(e,a){let{slots:l}=a;return w(()=>t(e.tag,{class:["v-card-text",e.class],style:[{"--v-card-text-opacity":e.opacity},e.style]},l)),{}}}),Bt=L({appendAvatar:String,appendIcon:j,disabled:Boolean,flat:Boolean,hover:Boolean,image:String,link:{type:Boolean,default:void 0},prependAvatar:String,prependIcon:j,ripple:{type:[Boolean,Object],default:!0},subtitle:{type:[String,Number,Boolean],default:void 0},text:{type:[String,Number,Boolean],default:void 0},title:{type:[String,Number,Boolean],default:void 0},...Me(),...U(),...oe(),..._e(),...Oe(),...je(),...Re(),...qe(),...Fe(),...Le(),...K(),...Ue(),...He({variant:"elevated"})},"VCard"),ae=B()({name:"VCard",directives:{Ripple:be},props:Bt(),setup(e,a){let{attrs:l,slots:n}=a;const{themeClasses:k}=Ie(e),{borderClasses:p}=Ce(e),{colorClasses:o,colorStyles:m,variantClasses:r}=Se(e),{densityClasses:d}=Ve(e),{dimensionStyles:s}=$e(e),{elevationClasses:y}=Ae(e),{loaderClasses:g}=Te(e),{locationStyles:b}=Ee(e),{positionClasses:v}=Pe(e),{roundedClasses:i}=Be(e),c=we(e,l),S=D(()=>e.link!==!1&&c.isLink.value),h=D(()=>!e.disabled&&e.link!==!1&&(e.link||c.isClickable.value));return w(()=>{const E=S.value?"a":e.tag,re=!!(n.title||e.title!=null),ce=!!(n.subtitle||e.subtitle!=null),de=re||ce,ue=!!(n.append||e.appendAvatar||e.appendIcon),me=!!(n.prepend||e.prependAvatar||e.prependIcon),ve=!!(n.image||e.image),he=de||me||ue,ke=!!(n.text||e.text!=null);return Ne(t(E,N({class:["v-card",{"v-card--disabled":e.disabled,"v-card--flat":e.flat,"v-card--hover":e.hover&&!(e.disabled||e.flat),"v-card--link":h.value},k.value,p.value,o.value,d.value,y.value,g.value,v.value,i.value,r.value,e.class],style:[m.value,s.value,b.value,e.style],onClick:h.value&&c.navigate,tabindex:e.disabled?-1:void 0},c.linkProps),{default:()=>{var X;return[ve&&t("div",{key:"image",class:"v-card__image"},[n.image?t(R,{key:"image-defaults",disabled:!e.image,defaults:{VImg:{cover:!0,src:e.image}}},n.image):t(We,{key:"image-img",cover:!0,src:e.image},null)]),t(Ye,{name:"v-card",active:!!e.loading,color:typeof e.loading=="boolean"?void 0:e.loading},{default:n.loader}),he&&t(Et,{key:"item",prependAvatar:e.prependAvatar,prependIcon:e.prependIcon,title:e.title,subtitle:e.subtitle,appendAvatar:e.appendAvatar,appendIcon:e.appendIcon},{default:n.item,prepend:n.prepend,title:n.title,subtitle:n.subtitle,append:n.append}),ke&&t(Y,{key:"text"},{default:()=>{var G;return[((G=n.text)==null?void 0:G.call(n))??e.text]}}),(X=n.default)==null?void 0:X.call(n),n.actions&&t(W,null,{default:n.actions}),ze(h.value,"v-card")]}}),[[De("ripple"),h.value&&e.ripple]])}),{}}}),wt=L({fullscreen:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,...Ze({origin:"center center",scrollStrategy:"block",transition:{component:xe},zIndex:2400})},"VDialog"),ne=B()({name:"VDialog",props:wt(),emits:{"update:modelValue":e=>!0,afterEnter:()=>!0,afterLeave:()=>!0},setup(e,a){let{emit:l,slots:n}=a;const k=Je(e,"modelValue"),{scopeId:p}=Ke(),o=T();function m(s){var b,v;const y=s.relatedTarget,g=s.target;if(y!==g&&((b=o.value)!=null&&b.contentEl)&&((v=o.value)!=null&&v.globalTop)&&![document,o.value.contentEl].includes(g)&&!o.value.contentEl.contains(g)){const i=et(o.value.contentEl);if(!i.length)return;const c=i[0],S=i[i.length-1];y===c?S.focus():c.focus()}}Xe(()=>{document.removeEventListener("focusin",m)}),Ge&&z(()=>k.value&&e.retainFocus,s=>{s?document.addEventListener("focusin",m):document.removeEventListener("focusin",m)},{immediate:!0});function r(){var s;l("afterEnter"),(s=o.value)!=null&&s.contentEl&&!o.value.contentEl.contains(document.activeElement)&&o.value.contentEl.focus({preventScroll:!0})}function d(){l("afterLeave")}return z(k,async s=>{var y;s||(await tt(),(y=o.value.activatorEl)==null||y.focus({preventScroll:!0}))}),w(()=>{const s=te.filterProps(e),y=N({"aria-haspopup":"dialog"},e.activatorProps),g=N({tabindex:-1},e.contentProps);return t(te,N({ref:o,class:["v-dialog",{"v-dialog--fullscreen":e.fullscreen,"v-dialog--scrollable":e.scrollable},e.class],style:e.style},s,{modelValue:k.value,"onUpdate:modelValue":b=>k.value=b,"aria-modal":"true",activatorProps:y,contentProps:g,height:e.fullscreen?void 0:e.height,width:e.fullscreen?void 0:e.width,maxHeight:e.fullscreen?void 0:e.maxHeight,maxWidth:e.fullscreen?void 0:e.maxWidth,role:"dialog",onAfterEnter:r,onAfterLeave:d},p),{activator:n.activator,default:function(){for(var b=arguments.length,v=new Array(b),i=0;i<b;i++)v[i]=arguments[i];return t(R,{root:"VDialog"},{default:()=>{var c;return[(c=n.default)==null?void 0:c.call(n,...v)]}})}})}),Qe({},o)}}),le=se("v-spacer","div","VSpacer"),Nt={key:0},Dt={key:1},Ht={key:2},Ut={key:3},Lt={key:4};function Ft(e,a,l,n,k,p){const o=A("SelectIcon"),m=A("HabitEntryChecklist");return u(),I(H,null,[e.loading?(u(),I("div",Nt,"Loading...")):V("",!0),e.habit.habit_type==="Yes or No"?(u(),I("div",Dt,[e.value==="1"?(u(),I("button",{key:0,onClick:a[0]||(a[0]=r=>e.updateEntry("0")),class:"habit-entry habit-entry--check",style:q({backgroundColor:e.colour})},null,4)):(u(),I("button",{key:1,onClick:a[1]||(a[1]=r=>e.updateEntry("1")),class:"habit-entry habit-entry--close"}))])):V("",!0),e.habit.habit_type==="Numerical"?(u(),I("div",Ht,[t(ne,{"max-width":"500",modelValue:e.modalIsActive,"onUpdate:modelValue":a[4]||(a[4]=r=>e.modalIsActive=r),persistent:""},{activator:f(({props:r})=>[t(F,{onClick:a[2]||(a[2]=d=>e.updateEntry((parseInt(e.value)+1).toString())),onMousedown:e.startHold,onMouseup:e.endHold,onTouchstart:e.startHold,onTouchend:e.endHold,color:"surface-variant",text:e.value||"-",variant:"flat",class:"habit-entry habit-entry--number",style:q(e.habitEntryStyle)},null,8,["onMousedown","onMouseup","onTouchstart","onTouchend","text","style"])]),default:f(({isActive:r})=>[t(ae,{title:`${e.habit.name}: ${e.date}`},{default:f(()=>[t(Y,null,{default:f(()=>[t(at,{modelValue:e.value,"onUpdate:modelValue":a[3]||(a[3]=d=>e.value=d),label:"Value",type:"number"},null,8,["modelValue"])]),_:1}),t(W,null,{default:f(()=>[t(le),t(F,{text:"Update Entry",onClick:d=>{r.value=!1,e.updateEntry(e.value)}},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["title"])]),_:1},8,["modelValue"])])):V("",!0),e.habit.habit_type==="Icon"?(u(),I("div",Ut,[t(ne,{"max-width":"500",modelValue:e.modalIsActive,"onUpdate:modelValue":a[6]||(a[6]=r=>e.modalIsActive=r),persistent:""},{activator:f(({props:r})=>[t(F,N(r,{onTouchstart:e.startHold,onTouchend:e.endHold,color:"surface-variant",variant:"flat",class:`habit-entry habit-entry--number mdi mdi-${e.value}`,style:e.value=="0"||e.value===null?null:{backgroundColor:`${e.colour} !important`}}),null,16,["onTouchstart","onTouchend","class","style"])]),default:f(({isActive:r})=>[t(ae,{title:`${e.habit.name}: ${e.date}`},{default:f(()=>[t(Y,null,{default:f(()=>[t(o,{modelValue:e.value.value,"onUpdate:modelValue":a[5]||(a[5]=d=>e.value.value=d),onUpdate:e.updateRecordIcon},null,8,["modelValue","onUpdate"])]),_:1}),t(W,null,{default:f(()=>[t(le),t(F,{text:"Update Entry",onClick:d=>r.value=!1},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["title"])]),_:1},8,["modelValue"])])):V("",!0),e.habit.habit_type==="Checklist"?(u(),I("div",Lt,[t(m,{colour:e.colour,date:e.date,value:e.value},null,8,["colour","date","value"])])):V("",!0)],64)}const _t=_(St,[["render",Ft]]);export{_t as H,Ot as g};
