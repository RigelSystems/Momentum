import{d as $,R as D,u as F,r as b,b as h,_ as v,e as w,w as i,f as d,o as p,g as r,V as E,a as S,t as y,h as I,i as g,j as N,k as A,c as f,l as C,F as k,m as T}from"./index-D9vtpAPl.js";import{S as V}from"./SelectIcon-DarmumKb.js";const B=$({name:"IconForm",props:{icon:{type:Object,required:!1,default:()=>({name:""})}},components:{RecordForm:D,SelectIcon:V},setup(o){F();const n=b([]),c=h(()=>!!o.icon.id),u=h(()=>c.value?`https://api.rigelsystems.co.uk/daily_discipline//icons/${o.icon.id}`:"https://api.rigelsystems.co.uk/daily_discipline//icons"),e=h(()=>c.value?"PUT":"POST");return{isEditMode:c,endpoint:u,method:e,handleSave:async t=>{window.location.reload()},value:n}}});function P(o,n,c,u,e,a){const t=d("n-button"),l=d("NPaint"),m=d("RecordForm");return p(),w(m,{record:o.icon,endpoint:o.endpoint,method:o.method,onSave:o.handleSave},{trigger:i(({openDialog:s})=>[I(o.$slots,"trigger",{openDialog:s},()=>[r(t,{color:"primary"},{default:i(()=>[g(y(o.isEditMode?"Edit Habit Group":"Add Habit Group"),1)]),_:1})])]),title:i(()=>[S("span",null,y(o.isEditMode?"Edit Habit Group":"Add New Habit Group"),1)]),form:i(({record:s})=>[r(E,null,{default:i(()=>[r(l,{pixelData:s.pixel_data,"onUpdate:pixelData":_=>s.pixel_data=_},null,8,["pixelData","onUpdate:pixelData"])]),_:2},1024)]),_:3},8,["record","endpoint","method","onSave"])}const U=v(B,[["render",P]]),j=$({name:"AdminView",components:{IconForm:U},setup(){console.log("AdminView setup called");const{accessToken:o}=N(),n=b([]),c=async()=>{try{const a=await fetch("https://api.rigelsystems.co.uk/daily_discipline//icons",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${o.value}`}});if(!a.ok)throw new Error("Failed to fetch icons");const t=await a.json();n.value=t}catch(e){console.error("Error fetching icons:",e)}};return console.log("accessToken:",o.value),A(o,e=>{e&&o.value&&(console.log("Access token changed, fetching icons..."),c())},{immediate:!0}),{accessToken:o,submitIcon:e=>{console.log("Submitting icon data:",e);try{const t=fetch("https://api.rigelsystems.co.uk/daily_discipline/admin/icons",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o.value}`},body:JSON.stringify(e)});if(!t.ok)throw new Error("Failed to submit icon");const l=t.json();console.log("Icon submitted successfully:",l)}catch(a){console.error("Error submitting icon:",a)}},iconData:n}}}),x={class:"standard-container p-1"},R={class:"icon-display-container"};function G(o,n,c,u,e,a){const t=d("n-button"),l=d("IconForm"),m=d("NPaintDisplay");return p(),f(k,null,[r(l,null,{trigger:i(({openDialog:s})=>[r(t,{onClick:s},{default:i(()=>n[0]||(n[0]=[g("New Icon")])),_:2},1032,["onClick"])]),_:1}),S("div",x,[o.iconData.length>0?(p(!0),f(k,{key:0},T(o.iconData,s=>(p(),f("div",R,[(p(),w(m,{key:s.id,pixelData:s.pixel_data,size:9},null,8,["pixelData"])),r(l,{icon:s},{trigger:i(({openDialog:_})=>[r(t,{onClick:_},{default:i(()=>n[1]||(n[1]=[g("Edit Icon")])),_:2},1032,["onClick"])]),_:2},1032,["icon"])]))),256)):C("",!0)])],64)}const z=v(j,[["render",G]]);export{z as default};
