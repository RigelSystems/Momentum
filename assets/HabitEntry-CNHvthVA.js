import{s as ye,d as ae,y as fe,j as ke,r as S,b as N,k as O,_ as ne,e as T,w as b,f as $,o as v,l as V,c as I,F as D,m as X,z as G,a as L,g as t,A as q,i as he,t as P,h as M,B as E,C as H,D as pe,E as B,G as U,H as W,I as le,J as Q,p as Z,K as j,L as se,M as F,N as ge,O as be,Q as Ce,S as Ie,T as Ve,U as Se,W as Ae,X as Te,Y as $e,Z as Pe,$ as Ee,a0 as Be,a1 as we,a2 as Ne,a3 as w,a4 as De,a5 as He,a6 as Ue,a7 as Le,a8 as Re,a9 as qe,aa as je,ab as Fe,ac as Me,ad as Oe,ae as ze,af as Ye,ag as We,ah as Je,ai as Ke,aj as Xe,ak as Ge,al as Qe,am as Ze,an as _e,ao as xe,ap as _,aq as et,n as tt,ar as R}from"./index-D0Qmzza5.js";import{S as at}from"./SelectIcon-CVMxzz4l.js";import{C as nt,a as lt}from"./ChecklistItemTask-DxJEDTtZ.js";function Et(e=1,l="YYYY-MM-DD"){return Array.from({length:e},(n,a)=>ye().subtract(a,"day").format(l))}const st=ae({name:"HabitEntryChecklist",components:{ChecklistItemWeightedExercise:lt,ChecklistItemTask:nt},props:{colour:{type:String,required:!0},date:{type:String,required:!0},value:{type:Number,required:!1}},setup(e){const{colour:l,value:n}=fe(e),{accessToken:a}=ke(),f=S(!1),C=S(null),i=S(null),y=S(!1),r=S(0),u=S(1),s=N(()=>({backgroundColor:n.value?l.value:"#f0f0f0"})),m=N(()=>{var k;return((k=i.value)==null?void 0:k.checklist_items[r.value])??null}),h="https://api.fordsdevelopment.co.uk/daily_discipline//checklists",p=async k=>{try{const A=await fetch(`${h}/${k}`,{headers:{Authorization:`Bearer ${a.value}`}});if(!A.ok)throw new Error(`Checklist fetch failed: ${A.status}`);i.value=await A.json()}catch(A){console.error(A)}};return O(C,k=>k&&p(k)),{show:f,checklistId:C,checklist:i,checklistStarted:y,currentItemIdx:r,currentSetIdx:u,styles:s,currentItem:m,checklistUrl:h,openDialog:()=>f.value=!0,closeDialog:()=>f.value=!1,startChecklist:()=>y.value=!0,nextAction:()=>{const k=m.value;k&&(k.sets&&u.value<k.sets?u.value++:(r.value++,u.value=1))},accessToken:a}}}),ot={class:"n-modal__title"},it={key:1,class:"standard-container-1"},rt={key:2};function dt(e,l,n,a,f,C){const i=$("NButton"),y=$("NSelectInputFromRequest"),r=$("NCircleProgress"),u=$("NModal");return v(),T(u,{show:e.show,"onUpdate:show":l[2]||(l[2]=s=>e.show=s)},{trigger:b(({openModal:s})=>[M(e.$slots,"trigger",{openDialog:s},()=>[t(i,{class:"habit-entry",style:q(e.styles),onClick:s},null,8,["style","onClick"])])]),header:b(()=>[M(e.$slots,"title",{},()=>[L("h2",ot,"Checklist - "+P(e.date),1)])]),footer:b(()=>[M(e.$slots,"actions",{},()=>{var s;return[e.checklistStarted?(v(),T(i,{key:0,label:"Back",onClick:l[1]||(l[1]=m=>e.currentItemIdx--)})):V("",!0),t(i,{class:"mx-2",colour:"secondary",label:"Cancel",onClick:e.closeDialog},null,8,["onClick"]),e.checklistId&&((s=e.checklist)!=null&&s.checklist_items)&&!e.checklistStarted?(v(),T(i,{key:1,label:"Start",onClick:e.startChecklist},null,8,["onClick"])):V("",!0),e.checklistStarted?(v(),T(i,{key:2,label:"Next",onClick:e.nextAction},null,8,["onClick"])):V("",!0)]})]),default:b(()=>{var s,m,h,p;return[e.checklistStarted?V("",!0):(v(),T(y,{key:0,url:e.checklistUrl,valueKey:"id",name:"role",label:"Select Checklist",modelValue:e.checklistId,"onUpdate:modelValue":l[0]||(l[0]=c=>e.checklistId=c),accessToken:e.accessToken},null,8,["url","modelValue","accessToken"])),e.checklistStarted?V("",!0):(v(),I("div",it,[(v(!0),I(D,null,X((s=e.checklist)==null?void 0:s.checklist_items,c=>(v(),T(G(`ChecklistItem${c.checklist_item_type_classify}`),{key:c.id,checklistItem:c},null,8,["checklistItem"]))),128))])),e.checklistStarted?(v(),I("div",rt,[l[3]||(l[3]=L("p",{class:"text-center"}," You have started the checklist. Please complete the items in your checklist. ",-1)),t(r,{current:e.currentItemIdx+1,total:(m=e.checklist)==null?void 0:m.checklist_items.length,fontSize:35,size:40,strokeWidth:11,progressColor:"#88bdb9"},null,8,["current","total"]),(v(),T(G(`ChecklistItem${(h=e.currentItem)==null?void 0:h.checklist_item_type_classify}`),{checklistItem:e.currentItem},null,8,["checklistItem"])),(v(!0),I(D,null,X((p=e.currentItem)==null?void 0:p.sets,c=>{var o,d;return v(),I("div",{key:c},[L("p",{style:q({border:c===e.currentSetIdx?"1px solid grey":""})},[L("strong",null,"Set "+P(c)+":",1),he(" "+P((o=e.currentItem)==null?void 0:o.reps)+" reps at "+P((d=e.currentItem)==null?void 0:d.weight)+" kg ",1)],4)])}),128))])):V("",!0)]}),_:3},8,["show"])}const ut=ne(st,[["render",dt]]),ct=ae({name:"HabitEntry",props:{accessToken:{type:String,required:!1},entry:{type:Object,required:!1},habit:{type:Object,required:!0},date:{type:String,required:!0},colour:{type:String,required:!0},loading:{type:Boolean,required:!1}},components:{SelectIcon:at,HabitEntryChecklist:ut},setup(e,{emit:l}){var c;let n=!1,a=S(((c=e.entry)==null?void 0:c.value)||0);const f=N(()=>{var g;let o=null;const d=(g=e.entry)==null?void 0:g.value.toString().length;return d===1?o="18px":d===2?o="16px":d===3?o="10px":d===4?o="8px":d>=5&&(o="6px"),{fontSize:o,backgroundColor:a.value==="0"||a.value===null?null:`${e.colour} !important`}}),C=async o=>{n=!0;const d=`https://api.fordsdevelopment.co.uk/daily_discipline/habit_entries/${e.entry.id}`;return await fetch(d,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.accessToken}`},body:JSON.stringify({value:o})})},i=async o=>(n=!0,await fetch("https://api.fordsdevelopment.co.uk/daily_discipline/habit_entries",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.accessToken}`},body:JSON.stringify({habit_id:e.habit.id,date:e.date,value:o})})),y=async o=>{n=!0;const d=e.entry?await C(o):await i(o);if(d.ok){n=!1;const g=await d.json();a.value=g.value,console.log("updated entry",g),l("updated")}else{n=!1;const g=await d.json();console.error(g)}};let r;const u=S(!1),s=()=>{r=setTimeout(()=>{u.value=!0},500)},m=()=>{clearTimeout(r)},h=o=>{o&&y(o)};return{entry:e.entry,updateEntry:y,loading:n,value:a,startHold:s,endHold:m,modalIsActive:u,updateRecordIcon:h,checklistUrl:"https://api.fordsdevelopment.co.uk/daily_discipline/checklists",habitEntryStyle:f}}}),z=E()({name:"VCardActions",props:H(),setup(e,l){let{slots:n}=l;return pe({VBtn:{slim:!0,variant:"text"}}),B(()=>{var a;return t("div",{class:["v-card-actions",e.class],style:e.style},[(a=n.default)==null?void 0:a.call(n)])}),{}}}),vt=U({opacity:[Number,String],...H(),...W()},"VCardSubtitle"),mt=E()({name:"VCardSubtitle",props:vt(),setup(e,l){let{slots:n}=l;return B(()=>t(e.tag,{class:["v-card-subtitle",e.class],style:[{"--v-card-subtitle-opacity":e.opacity},e.style]},n)),{}}}),yt=le("v-card-title"),ft=U({appendAvatar:String,appendIcon:F,prependAvatar:String,prependIcon:F,subtitle:{type:[String,Number,Boolean],default:void 0},title:{type:[String,Number,Boolean],default:void 0},...H(),...se()},"VCardItem"),kt=E()({name:"VCardItem",props:ft(),setup(e,l){let{slots:n}=l;return B(()=>{var u;const a=!!(e.prependAvatar||e.prependIcon),f=!!(a||n.prepend),C=!!(e.appendAvatar||e.appendIcon),i=!!(C||n.append),y=!!(e.title!=null||n.title),r=!!(e.subtitle!=null||n.subtitle);return t("div",{class:["v-card-item",e.class],style:e.style},[f&&t("div",{key:"prepend",class:"v-card-item__prepend"},[n.prepend?t(j,{key:"prepend-defaults",disabled:!a,defaults:{VAvatar:{density:e.density,image:e.prependAvatar},VIcon:{density:e.density,icon:e.prependIcon}}},n.prepend):t(D,null,[e.prependAvatar&&t(Q,{key:"prepend-avatar",density:e.density,image:e.prependAvatar},null),e.prependIcon&&t(Z,{key:"prepend-icon",density:e.density,icon:e.prependIcon},null)])]),t("div",{class:"v-card-item__content"},[y&&t(yt,{key:"title"},{default:()=>{var s;return[((s=n.title)==null?void 0:s.call(n))??P(e.title)]}}),r&&t(mt,{key:"subtitle"},{default:()=>{var s;return[((s=n.subtitle)==null?void 0:s.call(n))??P(e.subtitle)]}}),(u=n.default)==null?void 0:u.call(n)]),i&&t("div",{key:"append",class:"v-card-item__append"},[n.append?t(j,{key:"append-defaults",disabled:!C,defaults:{VAvatar:{density:e.density,image:e.appendAvatar},VIcon:{density:e.density,icon:e.appendIcon}}},n.append):t(D,null,[e.appendIcon&&t(Z,{key:"append-icon",density:e.density,icon:e.appendIcon},null),e.appendAvatar&&t(Q,{key:"append-avatar",density:e.density,image:e.appendAvatar},null)])])])}),{}}}),ht=U({opacity:[Number,String],...H(),...W()},"VCardText"),Y=E()({name:"VCardText",props:ht(),setup(e,l){let{slots:n}=l;return B(()=>t(e.tag,{class:["v-card-text",e.class],style:[{"--v-card-text-opacity":e.opacity},e.style]},n)),{}}}),pt=U({appendAvatar:String,appendIcon:F,disabled:Boolean,flat:Boolean,hover:Boolean,image:String,link:{type:Boolean,default:void 0},prependAvatar:String,prependIcon:F,ripple:{type:[Boolean,Object],default:!0},subtitle:{type:[String,Number,Boolean],default:void 0},text:{type:[String,Number,Boolean],default:void 0},title:{type:[String,Number,Boolean],default:void 0},...Oe(),...H(),...se(),...Me(),...Fe(),...je(),...qe(),...Re(),...Le(),...Ue(),...W(),...He(),...De({variant:"elevated"})},"VCard"),x=E()({name:"VCard",directives:{Ripple:ge},props:pt(),setup(e,l){let{attrs:n,slots:a}=l;const{themeClasses:f}=be(e),{borderClasses:C}=Ce(e),{colorClasses:i,colorStyles:y,variantClasses:r}=Ie(e),{densityClasses:u}=Ve(e),{dimensionStyles:s}=Se(e),{elevationClasses:m}=Ae(e),{loaderClasses:h}=Te(e),{locationStyles:p}=$e(e),{positionClasses:c}=Pe(e),{roundedClasses:o}=Ee(e),d=Be(e,n),g=N(()=>e.link!==!1&&d.isLink.value),k=N(()=>!e.disabled&&e.link!==!1&&(e.link||d.isClickable.value));return B(()=>{const A=g.value?"a":e.tag,oe=!!(a.title||e.title!=null),ie=!!(a.subtitle||e.subtitle!=null),re=oe||ie,de=!!(a.append||e.appendAvatar||e.appendIcon),ue=!!(a.prepend||e.prependAvatar||e.prependIcon),ce=!!(a.image||e.image),ve=re||ue||de,me=!!(a.text||e.text!=null);return we(t(A,w({class:["v-card",{"v-card--disabled":e.disabled,"v-card--flat":e.flat,"v-card--hover":e.hover&&!(e.disabled||e.flat),"v-card--link":k.value},f.value,C.value,i.value,u.value,m.value,h.value,c.value,o.value,r.value,e.class],style:[y.value,s.value,p.value,e.style],onClick:k.value&&d.navigate,tabindex:e.disabled?-1:void 0},d.linkProps),{default:()=>{var J;return[ce&&t("div",{key:"image",class:"v-card__image"},[a.image?t(j,{key:"image-defaults",disabled:!e.image,defaults:{VImg:{cover:!0,src:e.image}}},a.image):t(Ye,{key:"image-img",cover:!0,src:e.image},null)]),t(We,{name:"v-card",active:!!e.loading,color:typeof e.loading=="boolean"?void 0:e.loading},{default:a.loader}),ve&&t(kt,{key:"item",prependAvatar:e.prependAvatar,prependIcon:e.prependIcon,title:e.title,subtitle:e.subtitle,appendAvatar:e.appendAvatar,appendIcon:e.appendIcon},{default:a.item,prepend:a.prepend,title:a.title,subtitle:a.subtitle,append:a.append}),me&&t(Y,{key:"text"},{default:()=>{var K;return[((K=a.text)==null?void 0:K.call(a))??e.text]}}),(J=a.default)==null?void 0:J.call(a),a.actions&&t(z,null,{default:a.actions}),ze(k.value,"v-card")]}}),[[Ne("ripple"),k.value&&e.ripple]])}),{}}}),gt=U({fullscreen:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,...Ze({origin:"center center",scrollStrategy:"block",transition:{component:_e},zIndex:2400})},"VDialog"),ee=E()({name:"VDialog",props:gt(),emits:{"update:modelValue":e=>!0,afterEnter:()=>!0,afterLeave:()=>!0},setup(e,l){let{emit:n,slots:a}=l;const f=Je(e,"modelValue"),{scopeId:C}=Ke(),i=S();function y(s){var p,c;const m=s.relatedTarget,h=s.target;if(m!==h&&((p=i.value)!=null&&p.contentEl)&&((c=i.value)!=null&&c.globalTop)&&![document,i.value.contentEl].includes(h)&&!i.value.contentEl.contains(h)){const o=xe(i.value.contentEl);if(!o.length)return;const d=o[0],g=o[o.length-1];m===d?g.focus():d.focus()}}Xe(()=>{document.removeEventListener("focusin",y)}),Ge&&O(()=>f.value&&e.retainFocus,s=>{s?document.addEventListener("focusin",y):document.removeEventListener("focusin",y)},{immediate:!0});function r(){var s;n("afterEnter"),(s=i.value)!=null&&s.contentEl&&!i.value.contentEl.contains(document.activeElement)&&i.value.contentEl.focus({preventScroll:!0})}function u(){n("afterLeave")}return O(f,async s=>{var m;s||(await et(),(m=i.value.activatorEl)==null||m.focus({preventScroll:!0}))}),B(()=>{const s=_.filterProps(e),m=w({"aria-haspopup":"dialog"},e.activatorProps),h=w({tabindex:-1},e.contentProps);return t(_,w({ref:i,class:["v-dialog",{"v-dialog--fullscreen":e.fullscreen,"v-dialog--scrollable":e.scrollable},e.class],style:e.style},s,{modelValue:f.value,"onUpdate:modelValue":p=>f.value=p,"aria-modal":"true",activatorProps:m,contentProps:h,height:e.fullscreen?void 0:e.height,width:e.fullscreen?void 0:e.width,maxHeight:e.fullscreen?void 0:e.maxHeight,maxWidth:e.fullscreen?void 0:e.maxWidth,role:"dialog",onAfterEnter:r,onAfterLeave:u},C),{activator:a.activator,default:function(){for(var p=arguments.length,c=new Array(p),o=0;o<p;o++)c[o]=arguments[o];return t(j,{root:"VDialog"},{default:()=>{var d;return[(d=a.default)==null?void 0:d.call(a,...c)]}})}})}),Qe({},i)}}),te=le("v-spacer","div","VSpacer"),bt={key:0},Ct={key:1},It={key:2},Vt={key:3},St={key:4};function At(e,l,n,a,f,C){const i=$("SelectIcon"),y=$("HabitEntryChecklist");return v(),I(D,null,[e.loading?(v(),I("div",bt,"Loading...")):V("",!0),e.habit.habit_type==="Yes or No"?(v(),I("div",Ct,[e.value==="1"?(v(),I("button",{key:0,onClick:l[0]||(l[0]=r=>e.updateEntry("0")),class:"habit-entry habit-entry--check",style:q({backgroundColor:e.colour})},null,4)):(v(),I("button",{key:1,onClick:l[1]||(l[1]=r=>e.updateEntry("1")),class:"habit-entry habit-entry--close"}))])):V("",!0),e.habit.habit_type==="Numerical"?(v(),I("div",It,[t(ee,{"max-width":"500",modelValue:e.modalIsActive,"onUpdate:modelValue":l[4]||(l[4]=r=>e.modalIsActive=r),persistent:""},{activator:b(({props:r})=>[t(R,{onClick:l[2]||(l[2]=u=>e.updateEntry((parseInt(e.value)+1).toString())),onMousedown:e.startHold,onMouseup:e.endHold,onTouchstart:e.startHold,onTouchend:e.endHold,color:"surface-variant",text:e.value||"-",variant:"flat",class:"habit-entry habit-entry--number",style:q(e.habitEntryStyle)},null,8,["onMousedown","onMouseup","onTouchstart","onTouchend","text","style"])]),default:b(({isActive:r})=>[t(x,{title:`${e.habit.name}: ${e.date}`},{default:b(()=>[t(Y,null,{default:b(()=>[t(tt,{modelValue:e.value,"onUpdate:modelValue":l[3]||(l[3]=u=>e.value=u),label:"Value",type:"number"},null,8,["modelValue"])]),_:1}),t(z,null,{default:b(()=>[t(te),t(R,{text:"Update Entry",onClick:u=>{r.value=!1,e.updateEntry(e.value)}},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["title"])]),_:1},8,["modelValue"])])):V("",!0),e.habit.habit_type==="Icon"?(v(),I("div",Vt,[t(ee,{"max-width":"500",modelValue:e.modalIsActive,"onUpdate:modelValue":l[6]||(l[6]=r=>e.modalIsActive=r),persistent:""},{activator:b(({props:r})=>[t(R,w(r,{onTouchstart:e.startHold,onTouchend:e.endHold,color:"surface-variant",variant:"flat",class:`habit-entry habit-entry--number mdi mdi-${e.value}`,style:e.value=="0"||e.value===null?null:{backgroundColor:`${e.colour} !important`}}),null,16,["onTouchstart","onTouchend","class","style"])]),default:b(({isActive:r})=>[t(x,{title:`${e.habit.name}: ${e.date}`},{default:b(()=>[t(Y,null,{default:b(()=>[t(i,{modelValue:e.value.value,"onUpdate:modelValue":l[5]||(l[5]=u=>e.value.value=u),onUpdate:e.updateRecordIcon},null,8,["modelValue","onUpdate"])]),_:1}),t(z,null,{default:b(()=>[t(te),t(R,{text:"Update Entry",onClick:u=>r.value=!1},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["title"])]),_:1},8,["modelValue"])])):V("",!0),e.habit.habit_type==="Checklist"?(v(),I("div",St,[t(y,{colour:e.colour,date:e.date,value:e.value},null,8,["colour","date","value"])])):V("",!0)],64)}const Bt=ne(ct,[["render",At]]);export{Bt as H,Et as g};
