import{s as I,d as A,S as U,r as V,z as j,_ as B,c as s,p as m,A as C,g as a,w as n,B as $,F as N,f as q,o as i,C as g,D as T,h as F,E as S,j as v,G as M}from"./index-CeaCAxSM.js";function L(e=1,t="YYYY-MM-DD"){return Array.from({length:e},(p,y)=>I().subtract(y,"day").format(t))}const D=A({name:"HabitEntry",props:{accessToken:{type:String,required:!1},entry:{type:Object,required:!1},habit:{type:Object,required:!0},date:{type:String,required:!0},colour:{type:String,required:!0},fetchHabits:{type:Function,required:!0}},components:{SelectIcon:U},setup(e){var h;let t=!1,p=V(((h=e.entry)==null?void 0:h.value)||0);const y=async l=>{var k;t=!0;const u=`https://api.fordsdevelopment.co.uk/daily_discipline/habit_entries/${(k=e.entry)==null?void 0:k.id}`;return await fetch(u,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.accessToken}`},body:JSON.stringify({value:l})})},b=async l=>(t=!0,await fetch("https://api.fordsdevelopment.co.uk/daily_discipline/habit_entries",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.accessToken}`},body:JSON.stringify({habit_id:e.habit.id,date:e.date,value:l})})),f=async l=>{t=!0;const u=e.entry?await y(l):await b(l);if(u.ok){t=!1;const d=await u.json();p.value=d.value,e.fetchHabits()}else{t=!1;const d=await u.json();console.error(d)}};let c;const o=V(!1),r=()=>{c=setTimeout(()=>{o.value=!0},500)},w=()=>{clearTimeout(c)},E=l=>{l&&f(l)};return{entry:e.entry,updateEntry:f,loading:t,value:p,startHold:r,endHold:w,modalIsActive:o,updateRecordIcon:E}}}),H=j("v-spacer","div","VSpacer"),O={key:0},Y={key:1},z={key:2},P={key:3};function R(e,t,p,y,b,f){const c=q("SelectIcon");return i(),s(N,null,[e.loading?(i(),s("div",O,"Loading...")):m("",!0),e.habit.habit_type==="Yes or No"?(i(),s("div",Y,[e.value==="1"?(i(),s("button",{key:0,onClick:t[0]||(t[0]=o=>e.updateEntry("0")),class:"habit-entry habit-entry--check",style:C({backgroundColor:e.colour})},null,4)):(i(),s("button",{key:1,onClick:t[1]||(t[1]=o=>e.updateEntry("1")),class:"habit-entry habit-entry--close"}))])):m("",!0),e.habit.habit_type==="Numerical"?(i(),s("div",z,[a($,{"max-width":"500",modelValue:e.modalIsActive,"onUpdate:modelValue":t[4]||(t[4]=o=>e.modalIsActive=o),persistent:""},{activator:n(({props:o})=>[a(v,{onClick:t[2]||(t[2]=r=>e.updateEntry((parseInt(e.value)+1).toString())),onMousedown:e.startHold,onMouseup:e.endHold,onTouchstart:e.startHold,onTouchend:e.endHold,color:"surface-variant",text:e.value||"-",variant:"flat",class:"habit-entry habit-entry--number",style:C(e.value=="0"||e.value===null?null:{backgroundColor:`${e.colour} !important`})},null,8,["onMousedown","onMouseup","onTouchstart","onTouchend","text","style"])]),default:n(({isActive:o})=>[a(g,{title:`${e.habit.name}: ${e.date}`},{default:n(()=>[a(T,null,{default:n(()=>[a(F,{modelValue:e.value,"onUpdate:modelValue":t[3]||(t[3]=r=>e.value=r),label:"Value",type:"number"},null,8,["modelValue"])]),_:1}),a(S,null,{default:n(()=>[a(H),a(v,{text:"Update Entry",onClick:r=>{o.value=!1,e.updateEntry(e.value)}},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["title"])]),_:1},8,["modelValue"])])):m("",!0),e.habit.habit_type==="Icon"?(i(),s("div",P,[a($,{"max-width":"500",modelValue:e.modalIsActive,"onUpdate:modelValue":t[6]||(t[6]=o=>e.modalIsActive=o),persistent:""},{activator:n(({props:o})=>[a(v,M(o,{onTouchstart:e.startHold,onTouchend:e.endHold,color:"surface-variant",variant:"flat",class:`habit-entry habit-entry--number mdi mdi-${e.value}`,style:e.value=="0"||e.value===null?null:{backgroundColor:`${e.colour} !important`}}),null,16,["onTouchstart","onTouchend","class","style"])]),default:n(({isActive:o})=>[a(g,{title:`${e.habit.name}: ${e.date}`},{default:n(()=>[a(T,null,{default:n(()=>[a(c,{modelValue:e.value.value,"onUpdate:modelValue":t[5]||(t[5]=r=>e.value.value=r),onUpdate:e.updateRecordIcon},null,8,["modelValue","onUpdate"])]),_:1}),a(S,null,{default:n(()=>[a(H),a(v,{text:"Update Entry",onClick:r=>o.value=!1},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["title"])]),_:1},8,["modelValue"])])):m("",!0)],64)}const G=B(D,[["render",R]]);export{G as H,L as g};
