import{d as I,_ as v,c as d,e as U,z as V,o,b as B,a as k,g as a,t as F,l as j,F as b,m as S,w as u,f as h,i as T,P as E,v as q,j as A,r as _,x as H,k as P,q as z,p as L}from"./index-Cgf4cgv2.js";import{C as M}from"./ChecklistForm-CVAmU-F4.js";import{C as N,a as O,b as w}from"./ChecklistItemTask-IDx2T9T3.js";import{V as R}from"./VBreadcrumbs-Rlk1nwlX.js";import"./VTextarea-TlQpCjLC.js";import"./SelectIcon-BGrBlqS1.js";const D=I({name:"ChecklistItemTimedExercise",props:{checklistItem:{type:Object,required:!0}}});function W(e,s,i,c,m,t){return" Timed checklist item component "}const G=v(D,[["render",W]]),J=I({name:"ChecklistItem",props:{checklistItem:{type:Object,required:!0}},components:{ChecklistItemForm:w,ChecklistItemWeightedExercise:O,ChecklistItemTimedExercise:G,ChecklistItemTask:N}});function K(e,s,i,c,m,t){return o(),d("div",null,[(o(),U(V(`ChecklistItem${e.checklistItem.checklist_item_type_classify}`),{checklistItem:e.checklistItem},null,8,["checklistItem"]))])}const Q=v(J,[["render",K]]),X=I({name:"ChecklistItemRating",components:{ChecklistItemForm:w},props:{checklistItem:{type:Object,required:!0}},setup(e,{emit:s}){const i=()=>{s("save")},c=B(()=>{const t=parseFloat(e.checklistItem.value);return isNaN(t)||t<.5||t>5?0:t}),m=B(()=>{const t=Math.floor(c.value),l=c.value%1>=.5,r=5-t-(l?1:0);return{full:t,half:l?1:0,empty:r}});return{handleSave:i,stars:m,rating:c}}}),Y={class:"n-container-style"},Z={class:"checklist-item-name"},x={class:"checklist-item-status"},ee={class:"rating-stars"},te={key:0,class:"mdi mdi-star-half-full"},se={class:"rating-value"};function ce(e,s,i,c,m,t){const l=h("n-button"),r=h("ChecklistItemForm");return o(),d("div",Y,[k("h3",Z,F(e.checklistItem.name),1),k("div",x,[k("div",ee,[(o(!0),d(b,null,S(e.stars.full,n=>(o(),d("i",{key:"full-"+n,class:"mdi mdi-star"}))),128)),e.stars.half?(o(),d("i",te)):j("",!0),(o(!0),d(b,null,S(e.stars.empty,n=>(o(),d("i",{key:"empty-"+n,class:"mdi mdi-star-outline"}))),128)),k("span",se,"("+F(e.rating)+")",1)])]),a(r,{onSave:e.handleSave,checklistItem:e.checklistItem},{trigger:u(({openDialog:n})=>[a(l,{onClick:n},{default:u(()=>s[0]||(s[0]=[T("Edit item")])),_:2},1032,["onClick"])]),_:1},8,["onSave","checklistItem"])])}const ne=v(X,[["render",ce],["__scopeId","data-v-bc120b34"]]),ae=I({name:"ChecklistView",components:{PageHeader:E,ChecklistItemForm:w,ChecklistItem:Q,ChecklistForm:M,ChecklistItemTask:N,ChecklistItemRating:ne},setup(){const{getAccessTokenSilently:e,user:s}=q(),{accessToken:i}=A(),c=_({name:"",status:"",checklist_items:[]}),m=_(null),t=_(!0),l=_([{title:"Checklists",disabled:!1,href:"/#/checklists"}]),r=H(),n=_(r.params.id);P(()=>r.params.id,g=>{n.value=g});const f=async()=>{const g=`https://api.fordsdevelopment.co.uk/daily_discipline/checklists/${n.value}`,y=await fetch(g,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${i.value}`}});if(y.ok){t.value=!1;const C=await y.json();c.value=C,console.log(c.value),l.value.push({title:C.name,disabled:!0,href:`/checklists/${n}`})}else{t.value=!1;const C=await y.json();m.value=C.error}},$=async()=>{i.value=await e()};return z(async()=>{await $(),await f()}),{checklist:c,breadcrumbs:l,checklistItemBulkUpdateUrl:"https://api.fordsdevelopment.co.uk/daily_discipline/checklist_items/bulk_update",accessToken:i,errorMessage:m,loading:t,fetchChecklist:f}}}),oe={class:"page-header"},ie={class:"p-1"};function le(e,s,i,c,m,t){const l=h("PageHeader"),r=h("n-button"),n=h("ChecklistForm"),f=h("n-order-list"),$=h("ChecklistItemForm");return o(),d(b,null,[k("div",oe,[a(l,{title:e.checklist.name},null,8,["title"]),a(n,{checklist:e.checklist},{trigger:u(({openDialog:p})=>[a(r,{onClick:p},{default:u(()=>s[0]||(s[0]=[T("Edit List")])),_:2},1032,["onClick"])]),_:1},8,["checklist"]),a(R,{items:e.breadcrumbs},{prepend:u(()=>[a(L,{icon:"$vuetify",size:"small"})]),_:1},8,["items"])]),k("div",ie,[a(f,{items:e.checklist.checklist_items,updateUrl:e.checklistItemBulkUpdateUrl,accessToken:e.accessToken,loading:e.loading,modelName:"checklist_items"},{default:u(p=>[(o(),U(V(`ChecklistItem${p.checklist_item_type_classify}`),{checklistItem:p,onSave:e.fetchChecklist},null,40,["checklistItem","onSave"]))]),_:1},8,["items","updateUrl","accessToken","loading"])]),a($,null,{trigger:u(({openDialog:p})=>[a(r,{class:"m-1",onClick:p},{default:u(()=>s[1]||(s[1]=[T("New List Item")])),_:2},1032,["onClick"])]),_:1})],64)}const ke=v(ae,[["render",le]]);export{ke as default};
