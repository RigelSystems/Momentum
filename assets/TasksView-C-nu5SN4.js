import{d as g,P as h,j as w,r as _,k as C,_ as y,c as N,a as k,g as t,f as o,w as i,F as B,o as S,i as u,t as V}from"./index-D0Qmzza5.js";import{T as $}from"./TaskForm-Bk3-nAcB.js";import"./VTextarea-BlzolVWn.js";const F=g({name:"TasksView",components:{PageHeader:h,TaskForm:$},setup(){const{accessToken:s}=w(),e=_(!0),l=_([]),d=_(null),p=async()=>{const a=await fetch("https://api.fordsdevelopment.co.uk/daily_discipline/checklists",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${s.value}`}});if(a.ok){const n=await a.json();l.value=n.filter(m=>m.checklist_type==="tasks"),e.value=!1}else{const n=await a.json();d.value=n.error,e.value=!1}};return C(s,c=>{c&&p()},{immediate:!0}),{tasks:l,loading:e,errorMessage:d,handleTaskSaved:()=>{p()}}}}),j={class:"standard-container p-1"},P={class:"p-1"};function H(s,e,l,d,p,f){const c=o("PageHeader"),a=o("n-button"),n=o("TaskForm"),m=o("RouterLink"),T=o("NCard"),v=o("n-order-list");return S(),N(B,null,[k("div",j,[t(c,{title:"Tasks"})]),k("div",P,[t(n,{onSaved:s.handleTaskSaved},{trigger:i(({openDialog:r})=>[t(a,{onClick:r},{default:i(()=>e[0]||(e[0]=[u("New Task")])),_:2},1032,["onClick"])]),_:1},8,["onSaved"])]),t(v,{items:s.tasks,loading:s.loading,modelName:"tasks"},{default:i(r=>[t(T,{title:r.name},{content:i(()=>[k("p",null,V(r.description),1),t(m,{to:{name:"task",params:{id:r.id}},class:"mr-2"},{default:i(()=>e[1]||(e[1]=[u(" View ")])),_:2},1032,["to"])]),_:2},1032,["title"])]),_:1},8,["items","loading"])],64)}const L=y(F,[["render",H]]);export{L as default};
