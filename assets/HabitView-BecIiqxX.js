import{d as F,P as S,s as B,r as g,v as M,k as P,p as N,_ as Y,c as i,a as n,g as c,f as k,w as y,F as d,m as b,o as l,n as x,l as f,e as T,t as h,i as H}from"./index-C0D6pJh8.js";import{H as R,r as I}from"./requestApi-DCwPI35e.js";import{H as L,g as A}from"./HabitEntry-CjFDv6nv.js";import{V as O}from"./VBreadcrumbs-1B--L-K-.js";import"./SelectIcon-BrxRYRFz.js";import"./ChecklistItemForm-2XHpqb8o.js";const W=F({name:"HabitView",components:{PageHeader:S,HabitEntry:L,Habit:R},setup(){const t=A(365,"YYYY-MM-DD"),u=A(365,"ddd<br>D"),{getAccessTokenSilently:w,user:E}=B(),C=g(null),V=g(null),D=g(!0),_=g([{title:"Habits",disabled:!1,href:"/#/habits"}]),p=g({}),v=M(),m=g(v.params.id);P(()=>v.params.id,e=>{m.value=e}),N(async()=>{const e=`https://api.fordsdevelopment.co.uk/daily_discipline/habits/${m.value}`,a=I(e,"GET");try{const r=await a();console.log("Habit data:",r),p.value=r,console.log(r),_.value.push({title:r.name,disabled:!0,href:`/habits/${m}`})}catch{V.value="Failed to fetch records"}D.value=!1});const $=(e,a)=>e.habit_entries.find(r=>r.date===a),s=async()=>{C.value=await w()};N(async()=>{await s()});function o(e){if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}return{habit:p,breadcrumbs:_,lastSevenDays:t,lastSevenDaysNice:u,getHabitEntiryForDate:$,accessToken:C,getOrdinal:o}}}),q={class:"page-header"},z={class:"standard-container-3"},G={class:"standard-container-3"},U={class:"standard-container-3"},X={class:"standard-container-3"},j={class:"standard-container-3 calendar-yearly p-1"},J={class:"calendar-month-title"},K={class:"calendar-days-header"},Q={class:"calendar-days-grid"},Z={class:"calendar-day-number"},ee={class:"calendar-month-stats"},ae={class:"calendar-month-stat"},te={class:"calendar-month-stat"},se={class:"calendar-month-stat"};function oe(t,u,w,E,C,V){const D=k("PageHeader"),_=k("n-tab"),p=k("NDashboardTile"),v=k("n-tab-panel"),m=k("n-tabs"),$=k("HabitEntry");return l(),i(d,null,[n("div",q,[c(D,{title:t.habit.name},null,8,["title"]),c(O,{items:t.breadcrumbs},{prepend:y(()=>[c(x,{icon:"$vuetify",size:"small"})]),_:1},8,["items"])]),c(m,null,{tabs:y(({activeTab:s,setActiveTab:o})=>[c(_,{label:"Totals",active:s===0,onClick:e=>o(0)},null,8,["active","onClick"]),c(_,{label:"Averages",active:s===1,onClick:e=>o(1)},null,8,["active","onClick"]),c(_,{label:"Changes",active:s===2,onClick:e=>o(2)},null,8,["active","onClick"]),c(_,{label:"Records",active:s===3,onClick:e=>o(3)},null,8,["active","onClick"])]),default:y(({activeTab:s})=>[c(v,{index:0,activeTab:s},{default:y(()=>{var o,e;return[n("div",z,[((e=(o=t.habit)==null?void 0:o.dashboard_data_totals)==null?void 0:e.length)>0?(l(!0),i(d,{key:0},b(t.habit.dashboard_data_totals,(a,r)=>(l(),T(p,{key:r,title:a.title,value:a.value,icon:a.icon,colour:a.colour,bottomText:a.bottomText},null,8,["title","value","icon","colour","bottomText"]))),128)):f("",!0)])]}),_:2},1032,["activeTab"]),c(v,{index:1,activeTab:s},{default:y(()=>{var o,e;return[n("div",G,[((e=(o=t.habit)==null?void 0:o.dashboard_data_averages)==null?void 0:e.length)>0?(l(!0),i(d,{key:0},b(t.habit.dashboard_data_averages,(a,r)=>(l(),T(p,{key:r,title:a.title,value:a.value,icon:a.icon,colour:a.colour,bottomText:a.bottomText},null,8,["title","value","icon","colour","bottomText"]))),128)):f("",!0)])]}),_:2},1032,["activeTab"]),c(v,{index:2,activeTab:s},{default:y(()=>{var o,e;return[n("div",U,[((e=(o=t.habit)==null?void 0:o.dashboard_data_changes)==null?void 0:e.length)>0?(l(!0),i(d,{key:0},b(t.habit.dashboard_data_changes,(a,r)=>(l(),T(p,{key:r,title:a.title,value:a.value,icon:a.icon,colour:a.colour,bottomText:a.bottomText},null,8,["title","value","icon","colour","bottomText"]))),128)):f("",!0)])]}),_:2},1032,["activeTab"]),c(v,{index:3,activeTab:s},{default:y(()=>{var o,e;return[n("div",X,[((e=(o=t.habit)==null?void 0:o.dashboard_data_records)==null?void 0:e.length)>0?(l(!0),i(d,{key:0},b(t.habit.dashboard_data_records,(a,r)=>(l(),T(p,{key:r,title:a.title,value:a.value,icon:a.icon,colour:a.colour,bottomText:a.bottomText},null,8,["title","value","icon","colour","bottomText"]))),128)):f("",!0)])]}),_:2},1032,["activeTab"])]),_:1}),n("div",j,[(l(!0),i(d,null,b(t.habit.monthly_data,s=>{var o;return l(),i("div",{key:s.month,class:"calendar-month-card"},[n("h4",J,h(s.month)+" "+h(s.year||((o=t.habit.created_at)==null?void 0:o.slice(0,4))),1),n("div",K,[(l(),i(d,null,b(["Su","Mo","Tu","We","Th","Fr","Sa"],e=>n("span",{key:e,class:"calendar-day-header"},h(e),1)),64))]),n("div",Q,[(l(!0),i(d,null,b(s.first_day_of_week,e=>(l(),i("span",{key:"empty-"+e,class:"calendar-day-cell empty"}))),128)),(l(!0),i(d,null,b(s.entries,e=>(l(),i("div",{key:e.id,class:"calendar-day-cell",style:{position:"relative"}},[n("span",Z,[H(h(new Date(e.date).getDate()),1),n("sup",null,h(t.getOrdinal(new Date(e.date).getDate())),1)]),t.accessToken?(l(),T($,{key:0,entry:e.entry,habit:t.habit,date:e.date,colour:t.habit.colour,fetchHabits:t.fetchHabits,accessToken:t.accessToken},null,8,["entry","habit","date","colour","fetchHabits","accessToken"])):f("",!0)]))),128))]),n("div",ee,[n("p",ae,[u[0]||(u[0]=H("Total: ")),n("b",null,h(t.habit.habit_type==="Currency"?`£${s.total_entries}`:s.total_entries),1)]),n("p",te,[u[1]||(u[1]=H("Daily Average: ")),n("b",null,h(t.habit.habit_type==="Currency"?`£${s.daily_average}`:s.daily_average),1)]),n("p",se,[u[2]||(u[2]=H("Weekly Average: ")),n("b",null,h(t.habit.habit_type==="Currency"?`£${s.weekly_average}`:s.weekly_average),1)])])])}),128))])],64)}const ue=Y(W,[["render",oe]]);export{ue as default};
